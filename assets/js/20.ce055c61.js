(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{433:function(t,n,e){"use strict";e.r(n);var a=e(62),v=Object(a.a)({},(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"http-处理大文件的传输"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-处理大文件的传输"}},[t._v("#")]),t._v(" HTTP 处理大文件的传输")]),t._v(" "),e("p",[t._v("对于很大的文件，多达几个G，如果一次性传输的话，会有大量的等待时间，验证影响用户的体验。HTTP 针对这种情况，采用了范围请求的解决方案。允许客户端仅仅请求一个资源的一部分。")]),t._v(" "),e("p",[t._v("服务器要支持范围请求，需要加上响应头.\nAccept-Ranges: none；")]),t._v(" "),e("p",[t._v("来告知客户端是否支持范围请求。")]),t._v(" "),e("h1",{attrs:{id:"range-字段"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#range-字段"}},[t._v("#")]),t._v(" Range 字段")]),t._v(" "),e("p",[t._v("对于客户端，需要请求哪部分，需要使用 Range 这个请求头字段确定，格式为 bytes=x-y.")]),t._v(" "),e("ul",[e("li",[t._v("0-499 表示从开始到第499个字节。")]),t._v(" "),e("li",[t._v("500- 表示从500字节到文件终点。")]),t._v(" "),e("li",[t._v("-100 表示文件的最后 100 个字节。")])]),t._v(" "),e("p",[t._v("服务器收到请求后，首先研制范围的合法性，如果越界了就返回 416 错误码，否则读取了对应的片段，返回 206 状态码。")]),t._v(" "),e("p",[t._v("同时，服务器需要添加 Content-Range 字段，这个字段的格式根据请求头中 Range 字段的不同而有所差异。")]),t._v(" "),e("p",[t._v("请求 单段数据和请求多段数据，响应头是不一样的。")]),t._v(" "),e("p",[t._v("// 单个数据\nRange: bytes=0-9\n// 多段数据\nRange: bytes=0-9, 30-39")]),t._v(" "),e("h1",{attrs:{id:"单段数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#单段数据"}},[t._v("#")]),t._v(" 单段数据")]),t._v(" "),e("p",[t._v("对于单段数据的请求, 返回的格式\nHTTP/1.1 206 Partial Content\nContent-Length: 10\nAccept-Range: bytes\nContent-Range: bytes 0-9/100")]),t._v(" "),e("p",[t._v("0-9 表示请求的返回，100 表示资源的总大小。")]),t._v(" "),e("h1",{attrs:{id:"多段数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#多段数据"}},[t._v("#")]),t._v(" 多段数据")]),t._v(" "),e("p",[t._v("HTTP/1.1 206 Partial Content\nContent-Type:multipart/byteranges;boundary=0000010101\nAccept-Ranges: bytes;")]),t._v(" "),e("p",[t._v("--0000010101\nContent-Type: text/plain\nContent-Range: bytes 0-9/96")]),t._v(" "),e("p",[t._v("....")]),t._v(" "),e("p",[t._v("--0000010101--")]),t._v(" "),e("p",[t._v("Content-Type: multipart/byteranges;boundary=00000010101 表示的是：")]),t._v(" "),e("ol",[e("li",[t._v("请求一定是多段数据请求。")]),t._v(" "),e("li",[t._v("响应体中的分割符是 00000010101")])]),t._v(" "),e("p",[t._v("因此，各段数据之间会由分割符分开，而且在最后的分割符末尾添上 -- 表示结束。")])])}),[],!1,null,null,null);n.default=v.exports}}]);