# 代理缓存
对于 HTTP 缓存来说，如果每次客户端缓存都要到源服务器获取，会给源服务器的压力很大。

缓存代理，让代理服务器接管一部分的服务端的 HTTP 缓存，客户端缓存过期后就去代理缓存中获取，代理服务器过期之后才去源服务器获取。可以降低源服务器的压力。


## 源服务器控制

1. private 和 public
private 是禁止代理服务器缓存。
public 允许代理服务器缓存。

如果是私密数据，放到代理服务器是非常危险的，别人可以直接访问代理服务器拿到数据。
对于私密数据，应该使用 private 而不是 public。

2. proxy-revalidate
must-revalidate 客户端缓存过期就去源服务器获取。
proxy-revalidate 表示代理服务器缓存过去到源服务器获取。

3. s-maxage
可以设置缓存在代理服务器中可以存放多久。
Cache-Control: public, max-age=1000, s-maxage=2000


## 客户端控制

1. max-stale 
max-stale: 5 来对代理服务器上的缓存进行宽容处理，过期了不要紧，只要过期时间在 5 秒之内就可以从代理服务器获取。

2. min-fresh: 5 限制处理，在即将过期的前五秒之前的时间可以拿到，否则拿不到。


3. only-if-cached 表示客户端只会接受代理缓存，而不会接受服务器的响应。如果代理缓存无效，直接返回 504.
