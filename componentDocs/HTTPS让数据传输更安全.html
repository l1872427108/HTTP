<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTPS让数据传输更安全 | HTTP</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/http/assets/css/0.styles.a82bc65d.css" as="style"><link rel="preload" href="/http/assets/js/app.a9f7748e.js" as="script"><link rel="preload" href="/http/assets/js/2.fdc7410f.js" as="script"><link rel="preload" href="/http/assets/js/18.23de83c2.js" as="script"><link rel="prefetch" href="/http/assets/js/10.175862a4.js"><link rel="prefetch" href="/http/assets/js/11.da069018.js"><link rel="prefetch" href="/http/assets/js/12.93495841.js"><link rel="prefetch" href="/http/assets/js/13.8448399c.js"><link rel="prefetch" href="/http/assets/js/14.19259a4b.js"><link rel="prefetch" href="/http/assets/js/15.a5b6314d.js"><link rel="prefetch" href="/http/assets/js/16.f63eb92b.js"><link rel="prefetch" href="/http/assets/js/17.96dea844.js"><link rel="prefetch" href="/http/assets/js/19.3e2f9e36.js"><link rel="prefetch" href="/http/assets/js/20.ce055c61.js"><link rel="prefetch" href="/http/assets/js/21.9467c730.js"><link rel="prefetch" href="/http/assets/js/22.864cf96f.js"><link rel="prefetch" href="/http/assets/js/23.2ebd0b41.js"><link rel="prefetch" href="/http/assets/js/24.dc92fb3e.js"><link rel="prefetch" href="/http/assets/js/25.8a742a4a.js"><link rel="prefetch" href="/http/assets/js/26.7f50fc9d.js"><link rel="prefetch" href="/http/assets/js/27.1f4ad5a3.js"><link rel="prefetch" href="/http/assets/js/28.90b361f2.js"><link rel="prefetch" href="/http/assets/js/29.a5d3a86b.js"><link rel="prefetch" href="/http/assets/js/3.039192e6.js"><link rel="prefetch" href="/http/assets/js/4.bc7cf726.js"><link rel="prefetch" href="/http/assets/js/5.d250cb53.js"><link rel="prefetch" href="/http/assets/js/6.8779df89.js"><link rel="prefetch" href="/http/assets/js/7.ed1d2405.js"><link rel="prefetch" href="/http/assets/js/8.00f43ad9.js"><link rel="prefetch" href="/http/assets/js/9.e1c59f60.js">
    <link rel="stylesheet" href="/http/assets/css/0.styles.a82bc65d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/http/" class="home-link router-link-active"><!----> <span class="site-name">HTTP</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/http/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://github.com/l1872427108/uui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.npmjs.com/package/uu-uui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Npm
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/http/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="https://github.com/l1872427108/uui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.npmjs.com/package/uu-uui" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Npm
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/http/componentDocs/HTTP报文结构.html" class="sidebar-link">HTTP 报文结构</a></li><li><a href="/http/componentDocs/HTTP请求方法.html" class="sidebar-link">HTTP 请求方法</a></li><li><a href="/http/componentDocs/URI.html" class="sidebar-link">如何理解 URI？</a></li><li><a href="/http/componentDocs/HTTP状态码.html" class="sidebar-link">HTTP 状态码</a></li><li><a href="/http/componentDocs/HTTP特点.html" class="sidebar-link">HTTP 的特点。</a></li><li><a href="/http/componentDocs/Accept.html" class="sidebar-link">Accept</a></li><li><a href="/http/componentDocs/HTTP 怎么传输定长和不定长的数据.html" class="sidebar-link">HTTP 怎么传输定长和不定长的数据</a></li><li><a href="/http/componentDocs/HTTP处理大文件的传输.html" class="sidebar-link">HTTP 处理大文件的传输</a></li><li><a href="/http/componentDocs/HTTP处理表单数据的提交.html" class="sidebar-link">HTTP 处理表单数据的提交</a></li><li><a href="/http/componentDocs/HTTP1.1如何解决队头堵塞.html" class="sidebar-link">HTTP解决队头堵塞</a></li><li><a href="/http/componentDocs/Cookie.html" class="sidebar-link">Cookie和Session</a></li><li><a href="/http/componentDocs/HTTP代理.html" class="sidebar-link">HTTP代理</a></li><li><a href="/http/componentDocs/代理缓存.html" class="sidebar-link">代理缓存</a></li><li><a href="/http/componentDocs/数据如何传输.html" class="sidebar-link">数据如何传输</a></li><li><a href="/http/componentDocs/HTTP1.html" class="sidebar-link">HTTP/1</a></li><li><a href="/http/componentDocs/HTTP1.1.html" class="sidebar-link">HTTP/1.1</a></li><li><a href="/http/componentDocs/HTTP:2.0.html" class="sidebar-link">HTTP/2</a></li><li><a href="/http/componentDocs/HTTP:3.html" class="sidebar-link">HTTP/3</a></li><li><a href="/http/componentDocs/HTTPS.html" class="sidebar-link">HTTPS</a></li><li><a href="/http/componentDocs/HTTPS让数据传输更安全.html" class="active sidebar-link">HTTPS让数据传输更安全</a><ul class="sidebar-sub-headers"></ul></li></ul> </aside> <main class="page"> <div class="content__default"><h1 id="https让数据传输更安全"><a href="#https让数据传输更安全" class="header-anchor">#</a> HTTPS让数据传输更安全</h1> <h3 id="http的隐患"><a href="#http的隐患" class="header-anchor">#</a> HTTP的隐患</h3> <p>起初设计的 HTTP 协议的目的很单纯，就是为了传输超文本文件，也没有太强的加密传输的数据需求，所以 HTTP 保持明文传输数据的特征。</p> <p>所以，在传输过程中的每一个环节，数据都有可能背窃取或串改。浏览器和服务器之间还可能有一个中间人。</p> <p>在将 HTTP 数据交给 TCP 层之后，数据会经过用户电脑、WiFi路由器、运营商和目标服务器。</p> <h3 id="在-http-协议栈中引入安全层"><a href="#在-http-协议栈中引入安全层" class="header-anchor">#</a> 在 HTTP 协议栈中引入安全层</h3> <p>在 TCP 和 HTTP 之间插入一个安全层，所有经过安全层的数据都会被加密或者解密。</p> <p>对发起 HTTP 请求的数据进行加密操作和对接收到 HTTP 内容进行解密操作。</p> <h3 id="如何加密"><a href="#如何加密" class="header-anchor">#</a> 如何加密</h3> <ol><li>使用对称加密
加密和解密都使用相同的密钥, 需要知道加密方式和密钥。</li></ol> <ul><li>浏览器发送它支持的加密套件和一个随机数 client-random.</li> <li>服务器会从加密套件中选取一个加密套件，然后也生成一个随机数 service-random, 并一起返回给浏览器。</li> <li>最后浏览器和服务器分别返回确认信息。</li></ul> <p>当浏览器和服务器都有 client-random 和 service-random 。根据相同的方法将 clinet-random 和 service-random 混合起来生成一个密钥 master secret , 有了密钥和 加密套件就可以进行数据的加密传输了。</p> <p>但是传输 client-random 和 service-random 的过程是明文的, 随机数合成密钥的算法是公开的，黑客拿到随机数就可以拿到密钥。</p> <ol start="2"><li>使用非对称加密
非对称加密算法有 A、B 两把密钥，如果用 A 密钥加密，只能使用 B 密钥来解密； 反过来，如果 B 密钥加密，只能用 A 密钥 来解密.</li></ol> <ul><li>浏览器发送加密套件列表给服务器。</li> <li>服务器选择一个加密套件，服务器将公钥和加密套件一起发送给浏览器，服务器自己留有私钥。</li> <li>最后浏览器和服务器返回确认消息。</li></ul> <p>在浏览器发送数据给服务器端时，可以使用该公钥来加密数据。由于公钥加密的数据只能服务器私钥来解密。黑客就无法使用公钥来解密了。</p> <p>非对称加密的效率太低。影响到加解密数据的速度。影响用户打开时间。</p> <p>无法保证服务器发送给浏览器的数据的安全。黑客截获公钥, 服务器只能采用私钥来加密，私钥加密只有公钥能解密，就不能保证服务器端数据的安全.</p> <ol start="3"><li>对称加密和非对称加密结合
在传输数据阶段使用对称加密，对称加密的密钥采用非对称加密来传输。</li></ol> <ul><li>浏览器向服务器发送对称加密套件列表、非对称加密套件列表和随机数 client-random.</li> <li>服务器保存随机数 client-random, 选择对称加密和非对称加密的套件，然后生成随机数 service-random, 向浏览器发送加密套件、service-random 和 公钥。</li> <li>浏览器保存公钥，生成随机数 pre-master, 然后利用 公钥 对 pre-master 加密，并向服务器发送加密后的数据；</li> <li>最后服务器拿出自己的私钥，解密出 pre-master 数据，返回确认消息。</li></ul> <p>服务器和浏览器有了共同的 client-random、service-random 和 pre-master. 然后服务器和浏览器使用这三组随机数生成生成对称密钥。最终服务器和浏览器生成的密钥也是相同的。</p> <p>pre-master 是经过公钥加密之后传输的，所以黑客无法获取到 pre-master，这样黑客就无法生成密钥，也就保证了黑客无法破解传输过程中的数据了。</p> <h3 id="添加数字证书"><a href="#添加数字证书" class="header-anchor">#</a> 添加数字证书</h3> <p>通过对称加密和非对称加密结合的方式，实现了数据的加密传输。如果黑客通过 DNS 劫持将官网 IP 地址替换成黑客的 IP 地址，这样访问的其实是黑客的服务器，黑客就可以在自己的服务器上实现公钥和私钥。浏览器确不知道访问的是黑客的站点。</p> <p>要证明这个服务器就是它自己，需要使用权威机构颁发的证书，这个权威机构称为 CA，颁发的证书就是数字证书。</p> <p>数字证书的作用：1. 通过数字证书证明服务器的身份。2. 数字证书里面包含服务器公钥。</p> <p>服务器不会直接返回公钥给浏览器，而是返回数字证书，而公钥包含在数字证书中。</p> <p>浏览器端多一个验证证书的操作，通过之后，才可以继续。</p> <p>实现了服务器的身份认证功能。</p> <h3 id="如何申请数字证书"><a href="#如何申请数字证书" class="header-anchor">#</a> 如何申请数字证书</h3> <ul><li>首先官网需要准备一套私钥和公钥，私钥留着自己使用。</li> <li>官网向 CA 机构提交公钥、公司、站点等信息并等待认真，这个认证过程可能是收费的；</li> <li>CA 通过线上、线下多种渠道来验证官网提供信息的真实性，如果合法；</li> <li>如果审核通过，CA 机构会拿出自己的私钥，对表单的内容进行一连串的操作，包括了对明文资料进行 Hash 计算得出信息摘要，利用 CA 的私钥加密信息摘要得出数字签名，最后将数字签名也写在表单上，返回给官网。</li></ul> <h3 id="浏览器如何验证数字证书"><a href="#浏览器如何验证数字证书" class="header-anchor">#</a> 浏览器如何验证数字证书</h3> <ol><li>浏览器需要验证证书的有效性。</li> <li>浏览器需要验证数字证书是否被吊销了。两种方式，一种是下载吊销证书列表 CRL. 第二种是在线验证方式 - OCSP .</li> <li>验证数字证书是否是 CA 版本。 首先，浏览器利用证书的原始信息计算出信息摘要；然后，利用 CA 的公钥来解密数字证书中的数字签名，解密出来的信息也是信息摘要； 最后，判断两个信息摘要是否相等。</li></ol> <h3 id="浏览器如何获取到-ca-公钥"><a href="#浏览器如何获取到-ca-公钥" class="header-anchor">#</a> 浏览器如何获取到 CA 公钥</h3> <p>部署服务时，除了部署当前的数字证书，还需要部署 CA 机构的数字证书，CA 机构的数字证书就包括了 CA 的公钥以及 CA 机构的一些基础信息。</p> <p>官网服务器就有两个数字证书：给官网域名的数字证书 和 给官网签名的CA机构的数字证书。</p> <p>在建立 HTTPS 链接时，服务器会将这两个证书一同发送给浏览器，浏览器就获得了 CA 的公钥。</p> <p>就可以获取 CA 的公钥来验证数字证书的可靠性。</p> <h3 id="验证-ca-机构的合法性"><a href="#验证-ca-机构的合法性" class="header-anchor">#</a> 验证 CA 机构的合法性</h3> <p>将颁发证书的机构划分为两种类型，根 CA(Root CAs)和中间 CA(Intermediates CAs)。 通常申请者都是向中间 CA 去申请证书的，而根 CA 作用就是给中间 CA 做认证，一个根 CA 会认证很多中间的 CA，而这些中间 CA 又可以去认证其他的中间 CA。</p> <p>这样就形成于一条证书链，可以沿着证书链从用户证书追溯到根证书。</p> <h3 id="如何验证根证书的合法性"><a href="#如何验证根证书的合法性" class="header-anchor">#</a> 如何验证根证书的合法性</h3> <p>浏览器的判断策略很简单，它只是简单地判断这个根证书在不在操作系统里面，如果在，那么浏览器就认为这个根证书是合法的，如果不在，那么就是非法的。</p> <p>某个机构想要成为根 CA，并让它的根证书内置到操作系统中，那么这个机构首先要通过 WebTrust 国际安全审计认证。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/http/componentDocs/HTTPS.html" class="prev">
        HTTPS
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/http/assets/js/app.a9f7748e.js" defer></script><script src="/http/assets/js/2.fdc7410f.js" defer></script><script src="/http/assets/js/18.23de83c2.js" defer></script>
  </body>
</html>
